<section class="max-w-5xl mx-auto px-4 py-10" data-controller="template-modal">

  <!-- キャッチコピー部分 -->
  <div class="bg-stone-200 px-4 px-8 sm:px-8 sm:py-12 mb-8 sm:mb-10">
    <div class="max-w-2xl mx-auto">
      <p class="mb-6">
        <span class="block text-2xl md:text-3xl font-bold leading-snug text-stone-900">
        気持ちに、ひと工夫
        </span>
        <span class="block mt-2 text-base md:text-lg font-bold text-stone-500">
        演出付きで贈れる、デジタル手紙。
        </span>
      </p>

      <div class="flex justify-center sm:justify-end">
        <% if user_signed_in? %>
          <%= link_to "手紙を書く",
                      select_templates_path,
                      class: "px-6 py-2.5 rounded-md bg-gray-700 text-white text-sm font-semibold shadow hover:bg-gray-800 active:scale-95 transition" %>
        <% else %>
          <%= link_to "新規登録してはじめる",
                      new_user_registration_path,
                      class: "px-6 py-2.5 rounded-md bg-gray-700 text-white text-sm font-semibold shadow hover:bg-gray-800 active:scale-95 transition" %>
        <% end %>
      </div>
    </div>
  </div>

  <!-- デザイン一覧（便箋） -->
  <div class="max-w-3xl mx-auto mb-8">
    <h2 class="text-center text-sm font-semibold text-stone-800 mb-4">
      便箋デザイン一覧
    </h2>
    <div class="-mx-4 px-4 overflow-w-auto">
      <div class="flex gap-4 flex-nowrap justify-start">
        <% @stationery_templates.each do |template| %>
          <div class="w-28 shrink-0">
            <% if user_signed_in? %>
              <%= button_tag type:"button",
                              class: "block w-full text-left",
                              data: {
                                action: "click->template-modal#open",
                                template_id: template.id,
                                template_kind: template.kind,
                                template_title: template.title,
                                template_category: template.category,
                                template_thumbnail: asset_path(template.thumbnail_path)
                              } do %>
                <%= render "templates/card", template: template %>
              <% end %>
            <% else %>
              <%= render "templates/card", template: template %>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  </div>

  <!-- デザイン一覧（メッセージカード） -->
  <div class="max-w-3xl mx-auto">
    <h2 class="text-center text-sm font-semibold text-stone-800 mb-4">
      メッセージカードデザイン一覧
    </h2>
    <div class="flex justify-center gap-6">
      <% @message_card_templates.each do |template| %>
        <div class="w-28 md:w-32">
          <% if user_signed_in? %>
            <%= button_tag type: "button",
                            class: "block w-full text-left",
                            data: {
                              action: "click->template-modal#open",
                              template_id: template.id,
                              template_kind: template.kind,
                              template_title: template.title,
                              template_category: template.category,
                              template_thumbnail: asset_path(template.thumbnail_path)
                            } do %>
              <%= render "templates/card", template: template %>
            <% end %>
          <% else %>
            <%= render "templates/card", template: template %>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>
  <!-- モーダル（デフォルト非表示） -->
  <div data-template-modal-target="modal"
        class="hidden fixed inset-0 z-50"
        aria-modal="true">
    <!-- モーダルの背景(うっすら暗く) -->
    <div class="absolute inset-0 bg-black/40"
          data-action="click->template-modal#closeOnBackdrop">
    </div>
    
    <!-- パネル -->
    <div class="relative mx-auto mt-20 w-[92%] max-w-lg rounded-xl bg-white shadow-xl">
      <div class="flex items-center justify-between border-b px-4 py-3">
        <p class="text-sm font-semibold text-stone-800">デザインを確認</p>
        <button type="button"
                class="rounded-md px-2 py-1 text-stone-500 hover:bg-stone-100"
                data-action="click->template-modal#close">
          x
        </button>
      </div>

      <div class="px-4 py-4">
        <div class="flex gap-4">
          <img 
            data-template-modal-target="preview"
            class="w-40 md:w-44 h-auto rounded border border-stone-300 "
          >
          <div class="text-sm text-stone-700 space-y-3">
            <div>
              <p class="text-xs text-stone-500">kind</p>
              <p data-template-modal-target="kind" class="font-semibold"></p>
            </div>

            <div>
              <p class="text-xs text-tone-500">title</p>
              <p data-template-modal-target="title" class="font-semibold"></p>
            </div>

            <div>
              <p class="text-xs text-tone-500">category</p>
              <p data-template-modal-target="category" class="font-semibold"></p>
            </div>
          </div>
        </div>
        <div class="mt-4 flex justify-end gap-2">
          <button type="button"
                class="px-4 py-2 rounded-md bg-stone-100 text-stone-700 text-stone-700 font-semibold hover:bg-stone-200"
                data-action="click->template-modal#close">
          閉じる
          </button>
          <!-- buttonではなくa hrefに修正  -->
          <a
            data-template-modal-target="createLink"
                  class="px-4 py-2 rounded-md bg-gray-700 text-white text-sm font-semibold hover:bg-gray-800"
                  href="#"
          >
            このデザインで作成
          </a>
        </div>
      </div>
    </div>
  </div>
</section>